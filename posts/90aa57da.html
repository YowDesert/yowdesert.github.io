<!DOCTYPE html><html lang="zh-TW"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>(ä½œæ¥­ç³»çµ±) Process and Concurrency - Synchronization Concepts | YD's è³‡è¨Šå­¸ç¿’ç­†è¨˜</title><meta name="author" content="YowDesert"><meta name="copyright" content="YowDesert"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ç°¡çŸ­èªªæ˜ï¼š  ä¸»é¡Œï¼šSynchronization Concepts æœ¬ç« é‡é»ï¼š  ä»€éº¼æƒ…æ³ä¸‹æœƒç™¼ç”Ÿ Race Conditionï¼Ÿ ä½œæ¥­ç³»çµ±å¿…é ˆæ»¿è¶³å“ªäº›æ¢ä»¶ï¼Œæ‰èƒ½æ­£ç¢ºç®¡ç†å…±äº«è³‡æºï¼Ÿ æœ‰å“ªäº›åŒæ­¥æ©Ÿåˆ¶ï¼ˆSynchronization Mechanismsï¼‰å¯ä»¥ä¿è­‰ç¨‹å¼æ­£ç¢ºæ€§ï¼Ÿ      Background å•é¡Œèˆ‡è§£æ±º   The Problem :  Concurrent access to sh">
<meta property="og:type" content="article">
<meta property="og:title" content="(ä½œæ¥­ç³»çµ±) Process and Concurrency - Synchronization Concepts">
<meta property="og:url" content="https://yowdesert.github.io/posts/90aa57da.html">
<meta property="og:site_name" content="YD&#39;s è³‡è¨Šå­¸ç¿’ç­†è¨˜">
<meta property="og:description" content="ç°¡çŸ­èªªæ˜ï¼š  ä¸»é¡Œï¼šSynchronization Concepts æœ¬ç« é‡é»ï¼š  ä»€éº¼æƒ…æ³ä¸‹æœƒç™¼ç”Ÿ Race Conditionï¼Ÿ ä½œæ¥­ç³»çµ±å¿…é ˆæ»¿è¶³å“ªäº›æ¢ä»¶ï¼Œæ‰èƒ½æ­£ç¢ºç®¡ç†å…±äº«è³‡æºï¼Ÿ æœ‰å“ªäº›åŒæ­¥æ©Ÿåˆ¶ï¼ˆSynchronization Mechanismsï¼‰å¯ä»¥ä¿è­‰ç¨‹å¼æ­£ç¢ºæ€§ï¼Ÿ      Background å•é¡Œèˆ‡è§£æ±º   The Problem :  Concurrent access to sh">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://yowdesert.github.io/img/butterfly-icon.png">
<meta property="article:published_time" content="2025-08-14T00:40:00.000Z">
<meta property="article:modified_time" content="2025-12-13T09:35:17.970Z">
<meta property="article:author" content="YowDesert">
<meta property="article:tag" content="ä½œæ¥­ç³»çµ±">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yowdesert.github.io/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "(ä½œæ¥­ç³»çµ±) Process and Concurrency - Synchronization Concepts",
  "url": "https://yowdesert.github.io/posts/90aa57da.html",
  "image": "https://yowdesert.github.io/img/butterfly-icon.png",
  "datePublished": "2025-08-14T00:40:00.000Z",
  "dateModified": "2025-12-13T09:35:17.970Z",
  "author": [
    {
      "@type": "Person",
      "name": "YowDesert",
      "url": "https://YowDesert.github.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://yowdesert.github.io/posts/90aa57da.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="google5c543dcf16a66e3c.html"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-5975504062599634',
  enable_page_level_ads: 'true'
});</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'è¤‡è£½æˆåŠŸ',
    error: 'è¤‡è£½å¤±æ•—',
    noSupport: 'ç€è¦½å™¨ä¸æ”¯æ´'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'å‰›å‰›',
    min: 'åˆ†é˜å‰',
    hour: 'å°æ™‚å‰',
    day: 'å¤©å‰',
    month: 'å€‹æœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"å·²åˆ‡æ›ç‚ºç¹é«”ä¸­æ–‡","cht_to_chs":"å·²åˆ‡æ›ç‚ºç°¡é«”ä¸­æ–‡","day_to_night":"å·²åˆ‡æ›ç‚ºæ·±è‰²æ¨¡å¼","night_to_day":"å·²åˆ‡æ›ç‚ºæ·ºè‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'è¼‰å…¥æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '(ä½œæ¥­ç³»çµ±) Process and Concurrency - Synchronization Concepts',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="YD's è³‡è¨Šå­¸ç¿’ç­†è¨˜" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">è¼‰å…¥ä¸­...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      if ($loadingBox.classList.contains('loaded')) return
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()

  if (document.readyState === 'complete') {
    preloader.endLoading()
  } else {
    window.addEventListener('load', preloader.endLoading)
    document.addEventListener('DOMContentLoaded', preloader.endLoading)
    // Add timeout protection: force end after 7 seconds
    setTimeout(preloader.endLoading, 7000)
  }

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/backgroundPic.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">æ¨™ç±¤</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">åˆ†é¡</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/nav_Picture.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/Top.png" alt="Logo"><span class="site-name">YD's è³‡è¨Šå­¸ç¿’ç­†è¨˜</span></a><a class="nav-page-title" href="/"><span class="site-name">(ä½œæ¥­ç³»çµ±) Process and Concurrency - Synchronization Concepts</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  è¿”å›é¦–é </span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">(ä½œæ¥­ç³»çµ±) Process and Concurrency - Synchronization Concepts</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">ç™¼è¡¨æ–¼</span><time class="post-meta-date-created" datetime="2025-08-14T00:40:00.000Z" title="ç™¼è¡¨æ–¼ 2025-08-14 08:40:00">2025-08-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°æ–¼</span><time class="post-meta-date-updated" datetime="2025-12-13T09:35:17.970Z" title="æ›´æ–°æ–¼ 2025-12-13 17:35:17">2025-12-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BD%9C%E6%A5%AD%E7%B3%BB%E7%B5%B1/">ä½œæ¥­ç³»çµ±</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BD%9C%E6%A5%AD%E7%B3%BB%E7%B5%B1/Process-and-Concurrency/">Process and Concurrency</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">ç¸½å­—æ•¸:</span><span class="word-count">4.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é–±è®€æ™‚é–“:</span><span>18åˆ†é˜</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">ç€è¦½é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1>ç°¡çŸ­èªªæ˜ï¼š</h1>
<ul>
<li>ä¸»é¡Œï¼šSynchronization Concepts</li>
<li>æœ¬ç« é‡é»ï¼š
<ul>
<li>ä»€éº¼æƒ…æ³ä¸‹æœƒç™¼ç”Ÿ Race Conditionï¼Ÿ</li>
<li>ä½œæ¥­ç³»çµ±å¿…é ˆæ»¿è¶³å“ªäº›æ¢ä»¶ï¼Œæ‰èƒ½æ­£ç¢ºç®¡ç†å…±äº«è³‡æºï¼Ÿ</li>
<li>æœ‰å“ªäº›åŒæ­¥æ©Ÿåˆ¶ï¼ˆSynchronization Mechanismsï¼‰å¯ä»¥ä¿è­‰ç¨‹å¼æ­£ç¢ºæ€§ï¼Ÿ</li>
</ul>
</li>
</ul>
<hr>
<!-- <span style="color:red">data inconsistency</span> -->
<h1>Background</h1>
<h2 id="å•é¡Œèˆ‡è§£æ±º">å•é¡Œèˆ‡è§£æ±º</h2>
<ul>
<li>
<p>The Problem :</p>
<ul>
<li><strong>Concurrent access</strong> to shared data may result in <strong>data inconsistency</strong></li>
<li>Outcome depends on the <strong>order of execution</strong>(race condition)</li>
</ul>
</li>
<li>
<p>The Solution :</p>
<ul>
<li><strong>Ensure orderly execution</strong></li>
<li><strong>Synchronization</strong> : å”èª¿è³‡æºçš„åˆ†äº«èˆ‡å­˜å–</li>
<li>ä¿è­‰ <strong>Data Integrity</strong> å’Œ <strong>Correctness</strong></li>
</ul>
</li>
</ul>
<h2 id="Consumer-and-Producer-Problem">Consumer and Producer Problem :</h2>
<ul>
<li>
<p>è®Šæ•¸æ„ç¾© :</p>
<ul>
<li>inï¼šä¸‹ä¸€å€‹è¦æ”¾å…¥çš„ä½ç½®ï¼ˆnext free positionï¼‰</li>
<li>outï¼šä¸‹ä¸€å€‹è¦å–å‡ºçš„é …ç›®ä½ç½®ï¼ˆfirst available itemï¼‰</li>
<li>buffer æ˜¯ circular queueï¼ˆç’°ç‹€ï¼‰ï¼Œæ‰€ä»¥æœƒç”¨ <code>% BUFFER_SIZE</code></li>
</ul>
</li>
<li>
<p>Consumer and Producer Problem :</p>
<ul>
<li>Producer ç«¯é‚è¼¯
<ul>
<li><code>while (((in+1) % BUFFER_SIZE) == out) &#123;&#125;</code><br>
â†’ ä»£è¡¨ buffer æ»¿äº†ï¼ˆä¸‹ä¸€æ ¼å°±æ˜¯ outï¼Œè¡¨ç¤ºæ²’æœ‰ç©ºä½ï¼‰æ‰€ä»¥ä¸€ç›´ç­‰</li>
</ul>
</li>
<li>Consumer ç«¯é‚è¼¯
<ul>
<li><code>while (in == out) &#123;&#125;</code><br>
â†’ ä»£è¡¨ buffer ç©ºï¼ˆæ²’æœ‰å¯å–çš„ï¼‰</li>
</ul>
</li>
</ul>
</li>
<li>
<p>å¦‚æœåŠ ä¸Š Counter : ç›´æ¥è¨˜éŒ„ buffer å…§ã€Œç›®å‰æœ‰å¹¾å€‹ itemã€</p>
<ul>
<li>æ–°å¢è®Šæ•¸ : <code>counter = 0</code>ï¼šbuffer ç›®å‰ item æ•¸é‡</li>
<li>Producerï¼ˆç”¨ counterï¼‰
<ul>
<li>while <code>(counter == BUFFER_SIZE) &#123;&#125;</code> â†’ æ»¿äº†å°±ç­‰</li>
<li>æ”¾å…¥å¾Œ <code>counter++</code></li>
</ul>
</li>
<li>Consumerï¼ˆç”¨ counterï¼‰
<ul>
<li>while <code>(counter == 0) &#123;&#125;</code> â†’ ç©ºäº†å°±ç­‰</li>
<li>å–èµ°å¾Œ <code>counter--</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>ç°¡åŒ–æ³• : counter ++ èˆ‡ counter â€“ å…¶å¯¦æ˜¯3æ­¥é©Ÿ</p>
<ul>
<li>æŠŠ counter å¾è¨˜æ†¶é«”è®€åˆ°æš«å­˜å™¨</li>
<li>æš«å­˜å™¨ +1</li>
<li>å¯«å›è¨˜æ†¶é«”</li>
</ul>
</li>
<li>
<p>Problem :</p>
<ul>
<li>åœ¨é€™ 3 æ­¥ä¹‹é–“ï¼Œå¯èƒ½ç™¼ç”Ÿ <strong>context switch</strong> å„è‡ªè®€åˆ°èˆŠçš„å€¼ï¼Œæœ€å¾Œäº’ç›¸è¦†è“‹å°æ–¹å¯«å›çš„çµæœ =&gt; Race Condition</li>
</ul>
</li>
</ul>
<h2 id="Race-Condition">Race Condition</h2>
<ul>
<li>
<p>Race Condition æœƒç™¼ç”Ÿåœ¨ä»¥ä¸‹æƒ…æ³ :</p>
<ol>
<li>Multiple processes access and manipulate <strong>shared data concurrently</strong></li>
<li>The final value depends on which process finishes last</li>
<li>Outcome is <strong>unpredictable</strong>ï¼ˆtiming-dependentï¼‰</li>
</ol>
</li>
<li>
<p>Prevention : Synchronizationï¼ˆåŒæ­¥ï¼‰</p>
<ul>
<li><strong>Ensure only one process accesses shared data at a time</strong></li>
</ul>
</li>
<li>
<p>Simple Prevention (åªé©ç”¨æ–¼å–®æ ¸å¿ƒ)</p>
<ol>
<li>Disable Interruptsï¼ˆé—œé–‰ä¸­æ–·ï¼‰
<ul>
<li>é—œé–‰ä¸­æ–· â†’ CPU ä¸æœƒç™¼ç”Ÿ context switch</li>
</ul>
</li>
<li>Non-Preemptive Schedulingï¼ˆéæ¶å å¼æ’ç¨‹ï¼‰
<ul>
<li>Process ä¸€æ—¦é–‹å§‹åŸ·è¡Œï¼Œä¸<strong>æœƒè¢« OS å¼·åˆ¶åˆ‡æ›</strong></li>
</ul>
</li>
</ol>
</li>
<li>
<p>Both only work on single-processor systems</p>
</li>
</ul>
<h2 id="DeadLock">DeadLock</h2>
<ul>
<li>ä¸€é–‹å§‹ç‚ºå‡è¨­count = 0</li>
<li>Consumer é€²å…¥ CS First
<ol>
<li>entry-section() â†’ æ‹¿åˆ°é–</li>
<li><code>while (counter == 0) &#123; &#125;</code></li>
<li>Producer æƒ³é€²ä¾† ï¼Œ entry-section()ï¼ˆé–è¢« Consumer æ‹¿èµ°ï¼‰</li>
</ol>
<ul>
<li>Result:
<ul>
<li>Consumerï¼šç­‰ Producer ç”¢ç”Ÿè³‡æ–™</li>
<li>Producerï¼šç­‰ Consumer æ”¾é–</li>
</ul>
</li>
<li>äº’ç›¸ç­‰å¾… â†’ Deadlock</li>
</ul>
</li>
</ul>
<h2 id="åŸå‰‡">åŸå‰‡</h2>
<ul>
<li>åŸå‰‡ 1
<ul>
<li>ä¸è¦åœ¨ critical section è£¡é¢ã€Œç­‰æ¢ä»¶ã€ â†’ æœƒ deadlock</li>
</ul>
</li>
<li>åŸå‰‡ 2
<ul>
<li>critical section è¦ã€Œè¶Šå°è¶Šå¥½ã€ï¼ŒåªåŒ…çœŸæ­£éœ€è¦ä¿è­·çš„<strong>å…±äº«è³‡æ–™</strong></li>
</ul>
</li>
<li>åŸå‰‡3
<ul>
<li>äº’æ–¥ â‰  åŒæ­¥</li>
</ul>
</li>
</ul>
<h1>Critical-Section</h1>
<h2 id="The-Critical-Section-Problem">The Critical-Section Problem</h2>
<ul>
<li>Purposeï¼ˆç›®çš„ï¼‰:
<ul>
<li>Design a <strong>protocol</strong> : å…è¨±è™•ç†å™¨å€‘å”èª¿èˆ‡å®‰å…¨çš„å­˜å–å…±ç”¨çš„è³‡æ–™</li>
</ul>
</li>
<li>Problem Discription :
<ul>
<li><strong>N processes</strong> compete to <strong>use shared data</strong></li>
<li>Each process has a <strong>critical section</strong> - æ¯å€‹ process éƒ½æœ‰ä¸€æ®µç¨‹å¼ç¢¼ï¼Œæœƒã€Œ<strong>è®€ / å¯«å…±äº«è³‡æ–™</strong>ã€</li>
<li>Challengeï¼ˆæŒ‘æˆ°ï¼‰: ç•¶æŸå€‹ process æ­£åœ¨ critical section ï¼Œ å…¶ä»– process ä¸èƒ½ åŒæ™‚é€²å…¥å®ƒå€‘çš„ critical section</li>
<li>é€™å€‹æ€§è³ªå« <strong>mutual exclusionï¼ˆäº’æ–¥ï¼‰</strong></li>
</ul>
</li>
</ul>
<h2 id="Requirements-for-a-Valid-Solution">Requirements for a Valid Solution</h2>
<ol>
<li>Mutual Exclusion(äº’æ–¥æ€§):
<ul>
<li>åŒä¸€æ™‚é–“æœ€å¤šä¸€å€‹ process åœ¨ critical section</li>
<li>ç›®çš„ : é˜²æ­¢ <strong>Race condition</strong> ã€ ç¢ºä¿è³‡æ–™å®Œæ•´æ€§</li>
</ul>
</li>
<li>Progress (é€²å±•æ€§):
<ul>
<li>å¦‚æœï¼šcritical section æ˜¯ç©ºçš„ï¼Œæœ‰ process æƒ³é€²å»</li>
<li>é‚£éº¼ï¼š<strong>ä¸èƒ½ç„¡é™æœŸæ‹–å»¶</strong>ã€Œèª°å¯ä»¥é€²å»ã€çš„æ±ºå®š</li>
<li>æ±ºå®šä¸€å®šè¦åœ¨ <strong>æœ‰é™æ™‚é–“å…§å®Œæˆ</strong></li>
<li>ç›®çš„ : é˜²æ­¢ <strong>DeadLock</strong></li>
</ul>
</li>
<li>Bounded Waiting(æœ‰ç•Œç­‰å¾…):</li>
</ol>
<ul>
<li>ä¸€å€‹ process è«‹æ±‚é€²å…¥å¾Œ ï¼Œ å…¶ä»– process æœ€å¤šåªèƒ½æ’éšŠæœ‰é™æ¬¡</li>
<li>ç›®çš„ : é˜²æ­¢ <strong>starvation</strong>ï¼ˆé£¢é¤“ï¼‰</li>
</ul>
<h2 id="Critical-Section-Solutions-â€“-Software-Solutions">Critical Section Solutions â€“ Software Solutions</h2>
<ol>
<li>Software Solutions
<ul>
<li>
<p>Characteristics:</p>
<ul>
<li>Use only softwarealgorithms</li>
<li>åœ¨ä»»ä½•ç³»çµ±éƒ½èƒ½ç”¨</li>
</ul>
</li>
<li>
<p>Example:</p>
<ul>
<li>Petersonâ€™s Algorithmï¼ˆ2 å€‹ processï¼‰</li>
<li>Dekkerâ€™s Algorithmï¼ˆ2 å€‹ï¼‰</li>
<li>Bakery Algorithmï¼ˆN å€‹ï¼‰</li>
</ul>
</li>
</ul>
</li>
<li>Synchronization Hardwareï¼ˆç¡¬é«”æ”¯æ´ï¼‰
<ul>
<li>Characteristics:
<ul>
<li>Relies on <strong>atomic hardware instructions</strong></li>
</ul>
<blockquote>
<p>atomic hardware instructionsï¼ˆåŸå­ç¡¬é«”æŒ‡ä»¤ï¼‰ :<br>
æ˜¯ç”± CPU ä¿è­‰ã€Œæ•´å€‹æ“ä½œä¸å¯è¢«ä¸­æ–·ã€ä¸å¯è¢«æ‹†é–‹ã€çš„ä¸€æ¢æŒ‡ä»¤ï¼ˆæˆ–æŒ‡ä»¤çµ„ï¼‰ã€‚<br>
è¦å˜› å…¨éƒ¨åšå®Œï¼Œè¦å˜› å®Œå…¨æ²’åš</p>
</blockquote>
</li>
<li>Hardware Support
<ul>
<li>Test-and-Set</li>
<li>Compare-and-Swap (CAS)</li>
<li>Atomic variables</li>
</ul>
<blockquote>
<p>é€™äº›ä¿è­‰ã€Œä¸€æ•´å€‹æ“ä½œä¸å¯è¢«åˆ‡å‰²ã€</p>
</blockquote>
</li>
</ul>
</li>
<li>Semaphore
<ul>
<li>Characteristics:
<ul>
<li>ä¸€å€‹ <strong>æ•´æ•¸è®Šæ•¸</strong>ï¼Œé€é<strong>å…©å€‹åŸå­æ“ä½œ(atomic operation)</strong> å­˜å–</li>
<li>æä¾›By OS</li>
<li>More abstract than hardware instructions</li>
</ul>
</li>
<li>Operations:
<ul>
<li>wait() / P() - dercrement and block : æœƒå˜—è©¦å°‡ semaphore æ¸› 1 ä¸¦ é˜»å¡ã€‚</li>
<li>signal() / V() - increment and wake up wating process : æœƒå°‡ semaphore åŠ  1 ä¸¦å–šé†’ç­‰å¾…è€…ã€‚</li>
</ul>
</li>
<li>Types:
<ul>
<li>Binary semaphore(0 / 1) - é¡ä¼¼ mutex</li>
<li>Counting semaphore(0 ~ N) - resource counting</li>
</ul>
<blockquote>
<p>Mutexï¼ˆäº’æ–¥é–ï¼‰: Mutex ä¿è­‰ã€ŒåŒä¸€æ™‚é–“åªæœ‰ä¸€å€‹ thread èƒ½é€² critical sectionã€</p>
</blockquote>
</li>
<li>Mutual exclusion</li>
</ul>
</li>
<li>Monitor
<ul>
<li>
<p>Characteristics:</p>
<ul>
<li>é«˜éšæŠ½è±¡ï¼ˆHigh-level abstractionï¼‰</li>
<li>å°è£å…±äº«è³‡æ–™èˆ‡ç¨‹åº - å…±äº«è®Šæ•¸ä¸èƒ½è¢«å¤–é¢ç›´æ¥å­˜å–</li>
<li>è‡ªå‹•ä¿è­‰ Mutual Exclusion - åŒä¸€æ™‚é–“ï¼Œåªèƒ½ä¸€å€‹ process / thread åœ¨ monitor è£¡
<ul>
<li>é€²å…¥ Monitor â†’ è‡ªå‹•ä¸Šé–</li>
<li>é›¢é–‹ Monitor â†’ è‡ªå‹•è§£é–</li>
</ul>
</li>
<li>Synchronization : ä½¿ç”¨ condition variableï¼Œä½¿ç”¨ wait()ã€signal()</li>
</ul>
</li>
<li>
<p>Features :</p>
<ul>
<li>Only one process can be active</li>
<li>Condition Variablesï¼ˆæ¢ä»¶è®Šæ•¸ï¼‰for waiting and signaling</li>
<li>Compiler enforces synchronization rules</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="Comparison">Comparison</h2>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æŠ½è±¡å±¤ç´š</th>
<th>è¤‡é›œåº¦</th>
<th>ä¸»è¦å•é¡Œ</th>
</tr>
</thead>
<tbody>
<tr>
<td>Software</td>
<td>ä½</td>
<td>é«˜</td>
<td>è¤‡é›œã€busy waiting</td>
</tr>
<tr>
<td>Hardware</td>
<td>ä½</td>
<td>ä¸­</td>
<td>åªæ˜¯åŸºç¤ç©æœ¨</td>
</tr>
<tr>
<td>Semaphore</td>
<td>ä¸­</td>
<td>ä¸­</td>
<td><strong>å¾ˆå®¹æ˜“èª¤ç”¨</strong></td>
</tr>
<tr>
<td><strong>Monitor</strong></td>
<td><strong>é«˜</strong></td>
<td><strong>ä½</strong></td>
<td>éœ€è¦èªè¨€/ç·¨è­¯å™¨æ”¯æ´</td>
</tr>
</tbody>
</table>
<ul>
<li>Key Points
<ul>
<li>Hardware instructions æ˜¯ä¸€åˆ‡çš„åŸºç¤</li>
<li>Semaphore èˆ‡ Monitor æ˜¯ä¸åŒæŠ½è±¡å»ºæ–¼ç¡¬é«”ä¹‹ä¸Š</li>
</ul>
</li>
</ul>
<h1>Software Solutions</h1>
<h2 id="Algorithm-for-two-Processes">Algorithm for two Processes</h2>
<ul>
<li>Setup : Two Processes(P0 and P1)</li>
<li>Shared Variables : <code>int turn</code>;
<ul>
<li>$ turn_i $ ä»£è¡¨ è¼ªåˆ° Pi å¯ä»¥é€² critical section;</li>
</ul>
</li>
<li>How It Work : Processes <strong>Alternate</strong> entering the critical section
<ul>
<li>Process P0:
<ul>
<li>ä¸€ç›´ç­‰åˆ° turn == 0 æ‰é€²å» ï¼Œ å‡ºä¾†å¾ŒæŠŠ turn = 1</li>
</ul>
</li>
<li>Process P1:
<ul>
<li>ä¸€ç›´ç­‰åˆ° turn == 1 æ‰é€²å»å‡ºä¾†å¾ŒæŠŠ turn = 0</li>
</ul>
</li>
</ul>
</li>
<li>Analysis:
<ul>
<li>Mutual Exclusion : âœ…</li>
<li>Progress : âŒï¼ˆå¼·åˆ¶è¼ªæµï¼‰ï¼Œå³ä½¿ critical section æ˜¯ç©ºçš„ä¹Ÿä¸èƒ½é€²</li>
<li>Bound Waiting : âœ…</li>
</ul>
</li>
</ul>
<h2 id="Petersonâ€™s-Solution">Petersonâ€™s Solution</h2>
<ul>
<li>
<p>ä¸åªçœ‹ã€Œè¼ªåˆ°èª°ã€ï¼Œé‚„çœ‹<strong>å°æ–¹æƒ³ä¸æƒ³é€²</strong></p>
</li>
<li>
<p>Shared variables</p>
<ul>
<li>Boolean <strong>Flag</strong>[2]
<ul>
<li><code>flag[i] = true</code>ï¼šPi æƒ³é€² CSï¼ˆæœ‰æ„åœ–ï¼‰</li>
<li><code>flag[i] = false</code>ï¼šPi ä¸æƒ³é€²</li>
</ul>
</li>
<li>int <strong>turn</strong>
<ul>
<li>ç”¨ä¾†åœ¨ã€Œå…©å€‹éƒ½æƒ³é€²ã€æ™‚æ±ºå®šèª°å…ˆ</li>
</ul>
</li>
</ul>
</li>
<li>
<p>How It Work :</p>
<ol>
<li><code>flag[i] = true;</code> â†’ å®£å‘Šï¼šã€Œæˆ‘æƒ³é€²ã€</li>
<li><code>turn = j;</code> â†’ ç¦®è®“ï¼šã€Œå¦‚æœä½ ä¹Ÿæƒ³é€²ï¼Œé‚£å…ˆè®“ä½ ã€</li>
<li><code>while (flag[j] &amp;&amp; turn == j) ;</code> â†’ åªæœ‰åœ¨ã€Œ<strong>å°æ–¹æƒ³é€²</strong>ã€è€Œä¸”ã€Œ<strong>è¼ªåˆ°å°æ–¹</strong>ã€æ™‚æ‰ç­‰</li>
</ol>
</li>
<li>
<p>Key :</p>
<ul>
<li>å¦‚æœå…©å€‹åŒæ™‚æƒ³é€²:
<ul>
<li>Both set their flag to <strong>ture</strong></li>
<li><strong>Last Process</strong> to set <strong>turn</strong> will wait</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Analysis:</p>
<ul>
<li>Mutual Exclusion : âœ…</li>
<li>Progress : âœ…</li>
<li>Bound Waiting : âœ…</li>
</ul>
</li>
<li>
<p>Cons :</p>
<ul>
<li>Busy waitingï¼ˆä¸€ç›´ while ç©ºè½‰æµªè²» CPUï¼‰</li>
<li>åªé©ç”¨ 2 å€‹ process</li>
</ul>
</li>
</ul>
<h3 id="Correctness-Proof-of-Petersonâ€™s-Solution">Correctness Proof of Petersonâ€™s Solution</h3>
<ul>
<li>Mutual Exclusion : Contradiction(çŸ›ç›¾)
<ul>
<li>å‡è¨­ä¸€å€‹ä¸å¯èƒ½çš„äº‹ =&gt; P0ã€P1åŒæ™‚åœ¨ critical section</li>
<li>flag[0]ã€flag[1] = true ï¼Œ åªèƒ½é turnä¾†æ±ºå®šèª°èƒ½é€²</li>
<li>ä½†turnä¸èƒ½åŒæ™‚æ˜¯ 0 or 1 =&gt; çŸ›ç›¾ï¼</li>
</ul>
</li>
<li>Progress :
<ul>
<li>Scenario 1ï¼šåªæœ‰ P0 æƒ³é€²
<ul>
<li><code>flag[1]=false</code></li>
<li>P0 whileï¼š<code>flag[1] &amp;&amp; turn==1 â†’ false</code></li>
<li>âœ… P0 ç«‹åˆ»é€² â†’ ä¸æœƒè¢«ç„¡é™æ‹–å»¶</li>
</ul>
</li>
<li>Scenario 2ï¼šå…©å€‹éƒ½æƒ³é€²
<ul>
<li><code>Flag[0] Flag[1] = true;</code></li>
<li>æ±ºå®šåªçœ‹turnï¼Œè€Œturn åªèƒ½æ˜¯ 0 or 1ï¼Œæ‰€ä»¥åªæœ‰ä¸€å€‹äººæœƒé€² âœ…</li>
</ul>
</li>
</ul>
</li>
<li>Bounded waiting :
<ul>
<li>Case 1ï¼šP1 é€€å‡ºå¾Œä¸å†å›ä¾†
<ul>
<li>P1 å‡ºä¾†æœƒ <code>flag[1]=false</code></li>
<li>P0 çš„ while ç«‹åˆ»è®Š false</li>
<li>âœ… P0 ç›´æ¥é€²</li>
</ul>
</li>
<li>Case 2ï¼šP1 é€€å‡ºå¾Œåˆæƒ³å†é€²
<ul>
<li>P1 å†æ¬¡æƒ³é€²æ™‚æœƒï¼š
<ul>
<li><code>flag[1]=true</code></li>
<li>ä¸¦ä¸” è¨­ <code>turn=0</code>ï¼ˆç¦®è®“ P0ï¼‰</li>
<li>é€™æœƒè¦†è“‹æ‰ P0 å¯èƒ½è¨­çš„ <code>turn=1</code></li>
<li>æ­¤æ™‚å° P0 è€Œè¨€ï¼š
<ul>
<li>whileï¼š<code>flag[1] &amp;&amp; turn==1</code></li>
<li>å› ç‚º turn å·²ç¶“è®Š 0 â†’ false âœ… â†’ P0 é€²</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>P0 è«‹æ±‚é€²å…¥å¾Œï¼ŒP1 æœ€å¤šåªèƒ½é€²ä¸€æ¬¡ï¼ŒP0 ä¸æœƒç„¡é™ç­‰å¾…ã€‚</strong></li>
</ul>
</li>
</ul>
<h3 id="Turn-Algorithm-V-S-Petersonâ€™s-Algorithm">Turn Algorithm V.S. Petersonâ€™s Algorithm</h3>
<table>
<thead>
<tr>
<th>Featureï¼ˆç‰¹æ€§ï¼‰</th>
<th>Turn Algorithmï¼ˆStrict Alternationï¼‰</th>
<th>Petersonâ€™s Algorithm</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Mutual Exclusionï¼ˆäº’æ–¥ï¼‰</strong></td>
<td>âœ“ æ»¿è¶³</td>
<td>âœ“ æ»¿è¶³</td>
</tr>
<tr>
<td><strong>Progressï¼ˆé€²å±•æ€§ï¼‰</strong></td>
<td>âœ— <strong>ä¸æ»¿è¶³</strong><br>ï¼ˆå°æ–¹ä¸æƒ³é€²ä¹Ÿæœƒè¢«å¡ï¼‰</td>
<td>âœ“ æ»¿è¶³</td>
</tr>
<tr>
<td><strong>Bounded Waitingï¼ˆæœ‰ç•Œç­‰å¾…ï¼‰</strong></td>
<td>âœ“ æ»¿è¶³</td>
<td>âœ“ æ»¿è¶³</td>
</tr>
<tr>
<td><strong>Flexibilityï¼ˆå½ˆæ€§ï¼‰</strong></td>
<td>Lowï¼ˆåªçœ‹ turnï¼‰</td>
<td>Highï¼ˆçœ‹ intent + priorityï¼‰</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>Turn Algorithm</th>
<th>Petersonâ€™s Algorithm</th>
</tr>
</thead>
<tbody>
<tr>
<td>ä½¿ç”¨çš„è®Šæ•¸</td>
<td>åªæœ‰ <code>turn</code></td>
<td><code>flag[]</code> + <code>turn</code></td>
</tr>
<tr>
<td>è§£æ±ºçš„å•é¡Œ</td>
<td>åªä¿è­‰äº’æ–¥</td>
<td>åŒæ™‚ä¿è­‰äº’æ–¥ã€é€²å±•ã€å…¬å¹³</td>
</tr>
<tr>
<td>æœ€å¤§ç¼ºé™·</td>
<td><strong>é•å Progress</strong></td>
<td>ç„¡ï¼ˆç†è«–ä¸Šæ­£ç¢ºï¼‰</td>
</tr>
<tr>
<td>æ ¸å¿ƒæ¦‚å¿µ</td>
<td>åš´æ ¼è¼ªæµ</td>
<td>æ„åœ–ï¼ˆintentï¼‰ï¼‹å„ªå…ˆæ¬Šï¼ˆpriorityï¼‰</td>
</tr>
</tbody>
</table>
<h2 id="Dekkerâ€™s-Algorithm">Dekkerâ€™s Algorithm</h2>
<ul>
<li>ä½¿ç”¨çš„å…±äº«è®Šæ•¸</li>
<li>ç¬¬ä¸€å€‹ã€Œå®Œå…¨æ­£ç¢ºã€çš„ç´”è»Ÿé«” critical section è§£æ³•ï¼ˆ1960sï¼‰</li>
</ul>
<table>
<thead>
<tr>
<th>è®Šæ•¸</th>
<th>æ„ç¾©</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>flag[i]</code></td>
<td>Pi æ˜¯å¦ã€Œæƒ³é€²ã€ critical section</td>
</tr>
<tr>
<td><code>turn</code></td>
<td>ç•¶å…©å€‹éƒ½æƒ³é€²æ™‚ï¼Œèª°å„ªå…ˆ</td>
</tr>
</tbody>
</table>
<ul>
<li>Dekker çš„ Entry Sectionï¼ˆé‡é»æµç¨‹è¡¨ï¼‰</li>
<li>å‡è¨­ Pi æƒ³é€²ï¼ŒPj æ˜¯å°æ–¹ï¼š</li>
</ul>
<table>
<thead>
<tr>
<th>æ­¥é©Ÿ</th>
<th>ç¨‹å¼å‹•ä½œ</th>
<th>ç™½è©±è§£é‡‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><code>flag[i] = true</code></td>
<td>æˆ‘æƒ³é€²</td>
</tr>
<tr>
<td>2</td>
<td><code>while (flag[j])</code></td>
<td>å¦‚æœå°æ–¹ä¹Ÿæƒ³é€²</td>
</tr>
<tr>
<td>3</td>
<td><code>if (turn == j)</code></td>
<td>è€Œä¸”ç¾åœ¨è¼ªåˆ°ä»–</td>
</tr>
<tr>
<td>4</td>
<td><code>flag[i] = false</code></td>
<td>é‚£æˆ‘å…ˆé€€è®“ï¼ˆæš«æ™‚ä¸æƒ³é€²ï¼‰</td>
</tr>
<tr>
<td>5</td>
<td><code>while (turn == j)</code></td>
<td>ç­‰å°æ–¹ç”¨å®Œ</td>
</tr>
<tr>
<td>6</td>
<td><code>flag[i] = true</code></td>
<td>å†æ¬¡å®£å‘Šæˆ‘æƒ³é€²</td>
</tr>
<tr>
<td>7</td>
<td>é€² critical section</td>
<td>æ¢ä»¶æ»¿è¶³æ‰é€²</td>
</tr>
</tbody>
</table>
<ul>
<li>Dekker æœ€ç‰¹åˆ¥çš„åœ°æ–¹<br>
â†’ æœƒã€Œæš«æ™‚æ’¤å›æ„åœ–ï¼ˆwithdraw interestï¼‰ã€</li>
</ul>
<h3 id="Dekker-vs-Peterson">Dekker vs Peterson</h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Dekkerâ€™s Algorithm</th>
<th>Petersonâ€™s Algorithm</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ­·å²</td>
<td>ç¬¬ä¸€å€‹æ­£ç¢ºè§£ï¼ˆ1960sï¼‰</td>
<td>å¾Œä¾†æå‡º</td>
</tr>
<tr>
<td>Entry protocol</td>
<td>é€€è®“ï¼‹é‡æ–°å®£å‘Š</td>
<td>å®£å‘Šä¸€æ¬¡å³å¯</td>
</tr>
<tr>
<td>è¤‡é›œåº¦</td>
<td>âŒ è¤‡é›œ</td>
<td>âœ… ç°¡æ½”</td>
</tr>
<tr>
<td>Correctness</td>
<td>âœ“</td>
<td>âœ“</td>
</tr>
</tbody>
</table>
<ul>
<li>é—œéµå·®ç•°</li>
</ul>
<table>
<thead>
<tr>
<th>æ¯”è¼ƒé»</th>
<th>Dekker</th>
<th>Peterson</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç­‰å¾…æ™‚çš„è¡Œç‚º</td>
<td><strong>æœƒæš«æ™‚æ”¾æ£„æ„åœ–</strong></td>
<td>ä¸€ç›´ä¿æŒæƒ³é€²</td>
</tr>
<tr>
<td>flag çš„ä½¿ç”¨</td>
<td>å¯èƒ½è®Š false å† true</td>
<td>ä¸€æ¬¡è¨­ true</td>
</tr>
<tr>
<td>å¯è®€æ€§</td>
<td>å·®</td>
<td>å¥½</td>
</tr>
</tbody>
</table>
<h3 id="Limitations-of-Dekkerâ€™s-Algorithm">Limitations of Dekkerâ€™s Algorithm</h3>
<table>
<thead>
<tr>
<th>ç¼ºé»</th>
<th>èªªæ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>å¤ªè¤‡é›œ</td>
<td>entry protocol å¾ˆé›£å¯«å°</td>
</tr>
<tr>
<td>Busy waiting</td>
<td>æµªè²» CPU</td>
</tr>
<tr>
<td>åªé©ç”¨ 2 processes</td>
<td>ç„¡æ³•æ“´å……</td>
</tr>
<tr>
<td>è¨˜æ†¶é«”æ’åºè¦æ±‚é«˜</td>
<td>ç¾ä»£ CPU å¯èƒ½å£æ‰</td>
</tr>
<tr>
<td>å¯¦å‹™ä¸ä½¿ç”¨</td>
<td>è¢« mutex / semaphore å–ä»£</td>
</tr>
</tbody>
</table>
<h2 id="Bakery-Algorithm">Bakery Algorithm</h2>
<ul>
<li>ç¬¬ä¸€å€‹èƒ½è§£ã€Œ<strong>N å€‹ processes</strong>ã€çš„ç´”è»Ÿé«” critical section è§£æ³•</li>
<li>æ ¸å¿ƒæ¯”å–»</li>
</ul>
<table>
<thead>
<tr>
<th>ç¾å¯¦ä¸–ç•Œ</th>
<th>Bakery Algorithm</th>
</tr>
</thead>
<tbody>
<tr>
<td>å®¢äººæŠ½è™Ÿç¢¼</td>
<td>Process å– ticket</td>
</tr>
<tr>
<td>è™Ÿç¢¼å°çš„å…ˆæœå‹™</td>
<td>ticket å°çš„å…ˆé€² CS</td>
</tr>
<tr>
<td>è™Ÿç¢¼ä¸€æ¨£æ¯”å…ˆå¾Œ</td>
<td>ç”¨ process ID ç•¶ tiebreaker</td>
</tr>
<tr>
<td>å…¬å¹³ã€ä¸æ’éšŠ</td>
<td>ç„¡ starvation</td>
</tr>
</tbody>
</table>
<ul>
<li>Numbering scheme :
<ul>
<li>Generate numbers in non-decresing order (å¾Œä¸€å€‹æ•¸å­— &lt;= å‰ä¸€å€‹æ•¸å­—)</li>
<li>Duplicate numbers are possible!</li>
</ul>
</li>
<li>Tie-breaking rule:
<ul>
<li>Use <strong>Process ID</strong> as the tiebreaker</li>
</ul>
</li>
</ul>
<h3 id="æ’åºè¦å‰‡ï¼šLexicographic-Ordering-å­—å…¸é †åº">æ’åºè¦å‰‡ï¼šLexicographic Ordering (å­—å…¸é †åº)</h3>
<ul>
<li>
<p>Bakery æ¯”è¼ƒçš„æ˜¯ <strong>(number, process_id)</strong></p>
</li>
<li>
<p>Definition:<br>
$$<br>
(a,b) &lt; (c,d)ã€€ifã€€a &lt; cã€€ORã€€(a==cã€€ANDã€€b&lt;d)<br>
$$</p>
</li>
<li>
<p>å…ˆæ¯”è™Ÿç¢¼ ï¼Œ è™Ÿç¢¼ä¸€æ¨£ â†’ æ¯” process ID</p>
</li>
<li>
<p>å…±äº«è®Šæ•¸</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>è®Šæ•¸</th>
<th>æ„ç¾©</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>number[i]</code></td>
<td>Pi çš„è™Ÿç¢¼ç‰Œï¼ˆ0 = ä¸æƒ³é€²ï¼‰</td>
</tr>
<tr>
<td><code>choosing[i]</code></td>
<td>Pi æ˜¯å¦æ­£åœ¨é¸è™Ÿç¢¼</td>
</tr>
</tbody>
</table>
<h3 id="Bakery-Entry-Section">Bakery Entry Section</h3>
<ul>
<li>Step 1ï¼šæ‹¿è™Ÿç¢¼ï¼ˆGet Ticketï¼‰</li>
</ul>
<table>
<thead>
<tr>
<th>ç¨‹å¼ç¢¼</th>
<th>ç›®çš„</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>choosing[i] = true</code></td>
<td>å‘Šè¨´å¤§å®¶ï¼šæˆ‘åœ¨é¸è™Ÿç¢¼</td>
</tr>
<tr>
<td><code>number[i] = max(number[]) + 1</code></td>
<td>æ‹¿ä¸€å€‹æ¯”ç›®å‰æœ€å¤§é‚„å¤§çš„</td>
</tr>
<tr>
<td><code>choosing[i] = false</code></td>
<td>æˆ‘é¸å®Œäº†</td>
</tr>
</tbody>
</table>
<ul>
<li>Step 2ï¼šç­‰è¼ªåˆ°æˆ‘ï¼ˆWait for Turnï¼‰</li>
</ul>
<table>
<thead>
<tr>
<th>ç­‰å¾…æ¢ä»¶</th>
<th>æ„ç¾©</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>while (choosing[j])</code></td>
<td>ç­‰å°æ–¹é¸å®Œè™Ÿç¢¼</td>
</tr>
<tr>
<td><code>while (number[j] != 0 &amp;&amp; (number[j], j) &lt; (number[i], i))</code></td>
<td>å¦‚æœå°æ–¹è™Ÿç¢¼æ¯”è¼ƒå° â†’ ç­‰</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>Step 3ï¼šé€²å…¥ CS</p>
<ul>
<li>ç•¶ã€Œæ‰€æœ‰å„ªå…ˆæ¬Šæ¯”æˆ‘é«˜çš„éƒ½å®Œæˆã€â†’ æˆ‘å°±èƒ½é€²</li>
</ul>
</li>
<li>
<p>Exit Sectionï¼ˆRelease Ticketï¼‰</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>ç¨‹å¼ç¢¼</th>
<th>æ„ç¾©</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>number[i] = 0</code></td>
<td>é€€é‚„è™Ÿç¢¼ï¼Œä¸æƒ³é€²äº†</td>
</tr>
</tbody>
</table>
<h3 id="ç‚ºä»€éº¼ä¸€å®šè¦-choosing">ç‚ºä»€éº¼ä¸€å®šè¦ choosing[]?</h3>
<ul>
<li>æ²’æœ‰ choosing[]</li>
</ul>
<table>
<thead>
<tr>
<th>æ­¥é©Ÿ</th>
<th>ç™¼ç”Ÿçš„äº‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>P0 è®€ number â†’ max=0</td>
</tr>
<tr>
<td>2</td>
<td>context switch</td>
</tr>
<tr>
<td>3</td>
<td>P1 è®€ number â†’ max=0</td>
</tr>
<tr>
<td>4</td>
<td>P1 è¨­ number=1ï¼Œé€² CS</td>
</tr>
<tr>
<td>5</td>
<td>context switch</td>
</tr>
<tr>
<td>6</td>
<td>P0 è¨­ number=1ï¼Œä¹Ÿé€² CS âŒ</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>å…©å€‹äººæ‹¿åˆ°ä¸€æ¨£çš„è™Ÿç¢¼ï¼Œé‚„åŒæ™‚é€²å»</p>
</li>
<li>
<p>åŠ ä¸Š choosing[] å¾Œ</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>æ­¥é©Ÿ</th>
<th>æ”¹å–„</th>
</tr>
</thead>
<tbody>
<tr>
<td>P0 choosing=true</td>
<td>P1 çœ‹åˆ°ï¼Œå…ˆç­‰</td>
</tr>
<tr>
<td>P0 å®Œæˆ choosing</td>
<td>number[0]=1</td>
</tr>
<tr>
<td>P1 å†é¸</td>
<td>æ‹¿åˆ° number=2</td>
</tr>
</tbody>
</table>
<h3 id="Correctness-Proof">Correctness Proof</h3>
<ol>
<li>Mutual Exclusion</li>
</ol>
<ul>
<li>å‡è¨­ P0ã€P1 åŒæ™‚åœ¨ CSï¼š</li>
</ul>
<table>
<thead>
<tr>
<th>æ¨è«–</th>
<th>çµæœ</th>
</tr>
</thead>
<tbody>
<tr>
<td>P0 é€šéç­‰å¾…</td>
<td>(number[1],1) â‰¥ (number[0],0)</td>
</tr>
<tr>
<td>P1 é€šéç­‰å¾…</td>
<td>(number[0],0) â‰¥ (number[1],1)</td>
</tr>
<tr>
<td>åˆä½µ</td>
<td>å…©è€…äº’ç›¸å°æ–¼ âŒ</td>
</tr>
<tr>
<td>çµè«–</td>
<td><strong>å­—å…¸åºä¸å¯èƒ½ â†’ çŸ›ç›¾</strong></td>
</tr>
</tbody>
</table>
<ol start="2">
<li>Progress</li>
</ol>
<table>
<thead>
<tr>
<th>ç†ç”±</th>
<th>èªªæ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>æœ‰é™ number</td>
<td>ä¸€å®šå­˜åœ¨æœ€å° (number,id)</td>
</tr>
<tr>
<td>æœ€å°è€…</td>
<td>ä¸æœƒå†ç­‰ä»»ä½•äºº</td>
</tr>
<tr>
<td>çµæœ</td>
<td>ä¸€å®šèƒ½é€²ï¼ˆfinite timeï¼‰</td>
</tr>
</tbody>
</table>
<ol start="3">
<li>Bounded Waiting</li>
</ol>
<table>
<thead>
<tr>
<th>æ€§è³ª</th>
<th>èªªæ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>FIFO</td>
<td>ä¾ ticket æ’éšŠ</td>
</tr>
<tr>
<td>ä¸Šé™</td>
<td>Pi æ‹¿è™Ÿå¾Œï¼Œæœ€å¤š nâˆ’1 äººå…ˆé€²</td>
</tr>
<tr>
<td>çµæœ</td>
<td>ç„¡ starvation</td>
</tr>
</tbody>
</table>
<h3 id="Bekeryâ€™s-algorithmå„ªç¼ºé»ç¸½è¡¨">Bekeryâ€™s algorithmå„ªç¼ºé»ç¸½è¡¨</h3>
<ul>
<li>âœ… å„ªé»</li>
</ul>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>èªªæ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ”¯æ´ N processes</td>
<td>âœ”</td>
</tr>
<tr>
<td>å…¬å¹³</td>
<td>First-come, first-served</td>
</tr>
<tr>
<td>ç„¡ starvation</td>
<td>âœ”</td>
</tr>
<tr>
<td>ç´”è»Ÿé«”</td>
<td>ä¸é ç¡¬é«”</td>
</tr>
</tbody>
</table>
<ul>
<li>âŒ ç¼ºé»</li>
</ul>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>èªªæ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>Busy waiting</td>
<td>æµªè²» CPU</td>
</tr>
<tr>
<td>Entry O(n)</td>
<td>è¦æª¢æŸ¥æ‰€æœ‰ process</td>
</tr>
<tr>
<td>Space O(n)</td>
<td>number[], choosing[]</td>
</tr>
<tr>
<td>ä¸å¯¦ç”¨</td>
<td>ç¾ä»£ç³»çµ±ä¸ç”¨</td>
</tr>
</tbody>
</table>
<h3 id="å‰é¢çš„ç¸½çµ">å‰é¢çš„ç¸½çµ</h3>
<table>
<thead>
<tr>
<th>Algorithm</th>
<th>Processes</th>
<th>Mutual</th>
<th>Progress</th>
<th>Bounded</th>
<th>å¯¦ç”¨æ€§</th>
</tr>
</thead>
<tbody>
<tr>
<td>Turn</td>
<td>2</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ“</td>
<td>âŒ</td>
</tr>
<tr>
<td>Peterson</td>
<td>2</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td>æ•™å­¸</td>
</tr>
<tr>
<td>Dekker</td>
<td>2</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td>æ­·å²</td>
</tr>
<tr>
<td><strong>Bakery</strong></td>
<td><strong>N</strong></td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td>ç†è«–</td>
</tr>
</tbody>
</table>
<h2 id="Pthread-Lock-Mutex-Routines">Pthread Lock/Mutex Routines</h2>
<ul>
<li>åœ¨ Unix/Linux ç”¨ POSIX Threadsï¼ˆpthreadï¼‰å¯«å¤šåŸ·è¡Œç·’æ™‚ï¼Œæœ€å¸¸ç”¨çš„äº’æ–¥å·¥å…·å°±æ˜¯ mutex
<ul>
<li>ä¿è­‰åŒä¸€æ™‚é–“åªæœ‰ä¸€å€‹ thread é€²å…¥ critical sectionï¼ˆå…±äº«è³‡æ–™å€ï¼‰ = Mutual Exclusionï¼ˆäº’æ–¥ï¼‰</li>
</ul>
</li>
</ul>
<blockquote>
<p>Mutexï¼ˆäº’æ–¥é–ï¼‰: Mutex ä¿è­‰ã€ŒåŒä¸€æ™‚é–“åªæœ‰ä¸€å€‹ thread èƒ½é€² critical sectionã€<br>
ğŸ”’ mutex = é–<br>
ğŸš¶ thread = äºº</p>
</blockquote>
<ul>
<li>Pthread Mutex çš„åŸºæœ¬æµç¨‹  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">pthread_mutex_t mutex;</span><br><span class="line"></span><br><span class="line">// 1. åˆå§‹åŒ–</span><br><span class="line">pthread_mutex_init(&amp;mutex, NULL);</span><br><span class="line"></span><br><span class="line">// 2. ä¸Šé–ï¼ˆé€² critical sectionï¼‰</span><br><span class="line">pthread_mutex_lock(&amp;mutex);</span><br><span class="line"></span><br><span class="line">/* CRITICAL SECTION</span><br><span class="line">å­˜å– shared data</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">// 3. è§£é–ï¼ˆé›¢é–‹ critical sectionï¼‰</span><br><span class="line">pthread_mutex_unlock(&amp;mutex);</span><br><span class="line"></span><br><span class="line">// 4. ä¸ç”¨æ™‚éŠ·æ¯€</span><br><span class="line">pthread_mutex_destroy(&amp;mutex);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Condition-Variablesï¼ˆCVï¼‰">Condition Variablesï¼ˆCVï¼‰</h2>
<ul>
<li>CV:
<ul>
<li>Thread æƒ³è¦ç­‰ã€ŒæŸå€‹æ¢ä»¶æˆç«‹ã€å†ç¹¼çºŒåšäº‹</li>
<li>Notify other waiting thread that the condition has occured</li>
</ul>
</li>
<li>ä¸‰å€‹æ ¸å¿ƒæ“ä½œ:
<ul>
<li>wait() : è®“å‘¼å«è€…ã€Œç¡è‘—ã€ï¼Œç›´åˆ°æœ‰äººé€šçŸ¥å®ƒ ã€ wait æœƒåŸå­æ€§åœ°ã€Œé‡‹æ”¾ mutex ä¸¦é€²å…¥ç­‰å¾…</li>
<li>signal() : å–šé†’ ä¸€å€‹ æ­£åœ¨ wait çš„ thread ã€ å¦‚æœæ²’äºº waitï¼šè¨Šè™Ÿæœƒæ¶ˆå¤±</li>
<li>broadcast() : å–šé†’ å…¨éƒ¨ wait çš„ threadsã€å¤§å®¶æœƒæ¶ mutex ï¼Œ ä»æ˜¯ä¸€æ¬¡ä¸€å€‹èƒ½çœŸæ­£ç¹¼çºŒ</li>
</ul>
</li>
</ul>
<h1>Hardware Support for Synchronization</h1>
<h2 id="ç´”è»Ÿé«”çš„é™åˆ¶">ç´”è»Ÿé«”çš„é™åˆ¶</h2>
<ul>
<li>
<p>âŒã€€å…±äº«è®Šæ•¸çš„ä¿®æ”¹æœƒè¢«ã€Œä¸­æ–·ã€å¯èƒ½è¢« â†’ context switch æ‰“æ–·</p>
</li>
<li>
<p>âŒã€€å¤šæ­¥é©Ÿæ“ä½œä¸æ˜¯ atomic â†’ <code>load â†’ modify â†’ store</code> ä¸æ˜¯ä¸å¯åˆ†å‰²çš„</p>
</li>
<li>
<p>âŒã€€ç´”è»Ÿé«”è§£æ³•å¤ªä¾è³´ã€Œåš´æ ¼è¨˜æ†¶é«”é †åºã€</p>
</li>
<li>
<p><strong>éœ€è¦ç¡¬é«”æ”¯æ´çš„ atomic operationsï¼ˆåŸå­æ“ä½œï¼‰</strong></p>
</li>
</ul>
<h2 id="Approach-1-Disable-Interrupts">Approach 1: Disable Interrupts</h2>
<ul>
<li>
<p>Logic : ä¸è®“ä¸­æ–·ç™¼ç”Ÿ â†’ å°±ä¸æœƒè¢« context switch â†’ critical section å®‰å…¨</p>
</li>
<li>
<p>å–®æ ¸å¿ƒå•é¡Œ :</p>
<ul>
<li>â›” <strong>clock interrupt è¢«é—œ</strong> â†’ ç³»çµ±æ™‚é–“äº‚æ‰</li>
<li>â›” <strong>I/O interrupt è¢«åƒæ‰</strong> â†’ è£ç½®å¯èƒ½å£æ‰</li>
<li>â›” <strong>å®‰å…¨é¢¨éšª</strong>ï¼šuser process è‹¥èƒ½é—œä¸­æ–·ï¼Œç³»çµ±ç›´æ¥çˆ†ç‚¸</li>
</ul>
</li>
<li>
<p>å¤šæ ¸å¿ƒå•é¡Œ :</p>
<ul>
<li>â›” é—œçš„æ˜¯ã€Œæœ¬ CPUã€çš„ä¸­æ–· â†’ å…¶ä»– CPU é‚„æ˜¯èƒ½åŒæ™‚å­˜å– shared data</li>
</ul>
</li>
<li>
<p><strong>âŒ é—œä¸­æ–· ä¸æ˜¯é€šç”¨è§£æ³•</strong></p>
</li>
</ul>
<h2 id="Approach-2-Hardware-Atomic-Instructions">Approach 2: Hardware Atomic Instructions</h2>
<ul>
<li>
<p>Atomic Instruction :</p>
<ul>
<li><strong>ä¸€æ¬¡å®Œæˆ</strong></li>
<li><strong>ä¸å¯è¢«ä¸­æ–·</strong></li>
<li>CPU ç¡¬é«”ä¿è­‰</li>
</ul>
</li>
<li>
<p>Common Atomic Instruction :</p>
<ol>
<li>Test-and-Set
<ul>
<li>è®€ï¼‹å¯«ä¸€æ¬¡å®Œæˆ</li>
</ul>
</li>
<li>Compare-and-Swap (CAS)
<ul>
<li>åªæœ‰åœ¨ã€Œå€¼æ²’è®Šã€æ™‚æ‰æ›´æ–°</li>
</ul>
</li>
<li>Swap / Exchange
<ul>
<li>ç›´æ¥äº¤æ›å…©å€‹å€¼</li>
</ul>
</li>
</ol>
</li>
</ul>
<h2 id="Mutual-Exclusion-3-Common-Atomic-Instruction">Mutual Exclusion 3 Common Atomic Instruction</h2>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th><strong>Test-and-Set</strong></th>
<th><strong>Compare-and-Swap (CAS)</strong></th>
<th><strong>Swap / Exchange</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>åŸå­æŒ‡ä»¤åŠŸèƒ½</td>
<td>è®€èˆŠå€¼ä¸¦è¨­ç‚º true</td>
<td>æ¯”è¼ƒå¾Œæ‰äº¤æ›</td>
<td>ç›´æ¥äº¤æ›å…©å€‹å€¼</td>
</tr>
<tr>
<td>æ˜¯å¦ç¡¬é«”åŸå­æ“ä½œ</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
</tr>
<tr>
<td>å…±äº«è®Šæ•¸</td>
<td><code>boolean lock</code></td>
<td><code>boolean lock</code></td>
<td><code>boolean lock</code></td>
</tr>
<tr>
<td>è¼”åŠ©è®Šæ•¸</td>
<td>ç„¡</td>
<td>ç„¡</td>
<td><code>boolean key</code></td>
</tr>
<tr>
<td>lock åˆå§‹å€¼</td>
<td><code>false</code></td>
<td><code>false</code></td>
<td><code>false</code></td>
</tr>
<tr>
<td>é€²å…¥è‡¨ç•Œå€æ¢ä»¶</td>
<td>TestAndSet å›å‚³ <code>false</code></td>
<td>CAS æˆåŠŸï¼ˆfalse â†’ trueï¼‰</td>
<td>Swap å¾Œ <code>key == false</code></td>
</tr>
<tr>
<td>å¤±æ•—æ™‚è¡Œç‚º</td>
<td>ä¸€ç›´ spin</td>
<td>ä¸€ç›´ spin</td>
<td>ä¸€ç›´ spin</td>
</tr>
<tr>
<td>ç­‰å¾…æ–¹å¼</td>
<td>Busy waiting (spin)</td>
<td>Busy waiting (spin)</td>
<td>Busy waiting (spin)</td>
</tr>
<tr>
<td>è§£é–æ–¹å¼</td>
<td><code>lock = false</code></td>
<td><code>lock = false</code></td>
<td><code>lock = false</code></td>
</tr>
<tr>
<td>Mutual Exclusion</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
</tr>
<tr>
<td>Progress</td>
<td>âœ…</td>
<td>âœ…</td>
<td>âœ…</td>
</tr>
<tr>
<td>Bounded Waiting</td>
<td>âŒ</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td>å…¬å¹³æ€§</td>
<td>âŒ</td>
<td>âŒ</td>
<td>âŒ</td>
</tr>
<tr>
<td>CPU ä½¿ç”¨æ•ˆç‡</td>
<td>ä½ï¼ˆæµªè²» CPUï¼‰</td>
<td>ä½</td>
<td>ä½</td>
</tr>
<tr>
<td>ç¾ä»£å¯¦å‹™ä½¿ç”¨</td>
<td>åŸºæœ¬ spinlock</td>
<td>â­ æœ€å¸¸ç”¨ï¼ˆlock-freeï¼‰</td>
<td>å°‘ï¼ˆèˆŠç³»çµ±ï¼‰</td>
</tr>
</tbody>
</table>
<ul>
<li>Key Points:
<ul>
<li>ç¡¬é«”æ”¯æ´è®“åŒæ­¥è®Šç°¡å–®åˆå¿«</li>
<li>Atomic instructions æ˜¯ mutex ã€ semaphoreçš„åœ°åŸº</li>
<li>busy waiting ä»å­˜åœ¨ ã€ bounded waiting ä»éœ€è¨­è¨ˆ</li>
</ul>
</li>
</ul>
<h1>Semaphore</h1>
<ul>
<li>
<p>Purposeï¼ˆç›®çš„ï¼‰</p>
<ul>
<li>å®ƒæ˜¯ä¸€å€‹ã€Œ<strong>åŒæ­¥å·¥å…·</strong>ã€ï¼Œç”¨ä¾†ä¸€èˆ¬åŒ– critical section å•é¡Œ</li>
<li>æ¯”ç¡¬é«”åŸå­æŒ‡ä»¤<strong>æ›´é«˜éš</strong></li>
</ul>
</li>
<li>
<p>Definition</p>
<ul>
<li>æœ¬è³ªæ˜¯ä¸€å€‹ æ•´æ•¸ counter</li>
<li>å­˜å–åªèƒ½é€éå…©<strong>å€‹åŸå­æ“ä½œ</strong> : wait() ã€ signal()</li>
<li>Key propertyï¼šOperations are <strong>indivisible</strong>ï¼ˆä¸å¯åˆ†å‰²/åŸå­ï¼‰</li>
<li><strong>wait/signal ä¸€å®šè¦ atomic</strong></li>
</ul>
</li>
</ul>
<h2 id="Type-of-Semaphore">Type of Semaphore</h2>
<ul>
<li>
<p>Binary Semaphoreï¼ˆå€¼åªæœ‰ 0 æˆ– 1ï¼‰</p>
<ul>
<li>value=1ï¼šè³‡æºå¯ç”¨ / æ²’é–ï¼ˆunlockedï¼‰</li>
<li>value=0ï¼šè³‡æºä¸å¯ç”¨ / ä¸Šé–ï¼ˆlockedï¼‰</li>
<li>ç”¨é€”ï¼šäº’æ–¥ï¼ˆmutex lockï¼‰ï¼ˆä¸€æ¬¡åªèƒ½ä¸€å€‹äººé€² CSï¼‰</li>
</ul>
</li>
<li>
<p>Counting Semaphoreï¼ˆå€¼æ˜¯ 2â€¦Nï¼‰</p>
<ul>
<li>ä»£è¡¨ã€ŒåŒæ™‚å…è¨±æœ€å¤š N å€‹ã€ä½¿ç”¨è³‡æº</li>
<li>ç”¨é€”ï¼šè³‡æºæ•¸é‡æ§åˆ¶</li>
</ul>
</li>
</ul>
<h3 id="Two-Atomic-Operation">Two Atomic Operation :</h3>
<ul>
<li>
<p>wait(S) / P(S) / down(S)</p>
<ul>
<li>åšçš„äº‹ï¼šSâ€“</li>
<li>å¦‚æœ S è®Šæˆè² æ•¸ â†’ è¡¨ç¤ºã€Œè³‡æºä¸å¤ ã€â†’ å‘¼å«è€…è¦ blockï¼ˆç¡çœ ï¼‰</li>
</ul>
</li>
<li>
<p>signal(S) / V(S) / up(S)</p>
<ul>
<li>åšçš„äº‹ï¼šS++</li>
<li>å¦‚æœæœ‰äººåœ¨ç­‰ â†’ wakeup ä¸€å€‹</li>
</ul>
</li>
<li>
<p>Spinlock Implementation :</p>
<ul>
<li>wait(S)ï¼šç•¶ S-&gt;value &lt;= 0 å°±ä¸€ç›´ while è½‰åœˆï¼ˆbusy waitingï¼‰ï¼Œç›´åˆ°æœ‰è³‡æºå† valueâ€“</li>
<li>signal(S)ï¼švalue++</li>
</ul>
</li>
</ul>
<h3 id="Issue">Issue</h3>
<ul>
<li><strong>æµªè²» CPU cycles</strong>ï¼šä¸€ç›´ while æª¢æŸ¥</li>
<li><strong>å–®æ ¸å¿ƒæ›´ç³Ÿ</strong>ï¼šç­‰çš„äººä¸€ç›´å  CPUï¼ŒæŒé–è€…å¯èƒ½æ ¹æœ¬æ‹¿ä¸åˆ° CPU å»è§£é–</li>
</ul>
<h3 id="é©åˆæ™‚æ©Ÿ">é©åˆæ™‚æ©Ÿ</h3>
<ul>
<li>critical section å¾ˆçŸ­ï¼ˆä¸€ä¸‹å°±è§£é–ï¼‰</li>
<li>å¤šæ ¸å¿ƒ multiprocessorï¼šåˆ¥çš„ CPU ä»èƒ½å‰é€²ï¼ˆæŒé–è€…èƒ½è·‘ï¼‰</li>
</ul>
<h3 id="ä¸é©åˆæ™‚æ©Ÿ">ä¸é©åˆæ™‚æ©Ÿ</h3>
<ul>
<li>CS å¾ˆé•·</li>
<li>CPU è³‡æºå°‘</li>
<li>å–®æ ¸å¿ƒ</li>
</ul>
<h2 id="Non-busy-waitingï¼ˆæœ‰ç­‰å¾…éšŠåˆ—çš„-semaphoreï¼ŒçœŸæ­£-OS-æœƒç”¨ï¼‰">Non-busy waitingï¼ˆæœ‰ç­‰å¾…éšŠåˆ—çš„ semaphoreï¼ŒçœŸæ­£ OS æœƒç”¨ï¼‰</h2>
<ul>
<li>
<p>ä¸è¦å¿™ç­‰ï¼Œæ”¹æˆ block/wakeup</p>
</li>
<li>
<p>wait(S)ï¼šå…ˆ S-&gt;valueâ€“</p>
<ul>
<li>å¦‚æœè®Šæˆ &lt; 0ï¼šä»£è¡¨è¦ç­‰<br>
â†’ æŠŠè‡ªå·±æ”¾åˆ°ç­‰å¾…éšŠåˆ— S-&gt;list<br>
â†’ å‘¼å« block()ï¼ˆç¡çœ ï¼ŒOS æŠŠä½ ç§»å‡º ready queueï¼‰</li>
</ul>
</li>
<li>
<p>signal(S)ï¼šå…ˆ S-&gt;value++</p>
<ul>
<li>å¦‚æœçµæœ &lt;= 0ï¼šè¡¨ç¤ºã€Œé‚„æœ‰äººåœ¨ç­‰ã€ï¼ˆå› ç‚ºè² å€¼ä»£è¡¨ç­‰å¾…äººæ•¸ï¼‰<br>
â†’ å¾ S-&gt;list å–å‡ºä¸€å€‹<br>
â†’ wakeup(P) æŠŠå®ƒæ”¾å› ready queue</li>
</ul>
</li>
<li>
<p>Valueæ„ç¾©:</p>
<ul>
<li>S &gt; 0ï¼šé‚„æœ‰ S å€‹è³‡æºå¯ç”¨ï¼ˆä¸‹ä¸€å€‹ wait ä¸æœƒ blockï¼‰</li>
<li>S = 0ï¼šè³‡æºå‰›å¥½ç”¨å®Œï¼ˆä¸‹ä¸€å€‹ wait æœƒ blockï¼‰</li>
<li>S &lt; 0ï¼š
<ul>
<li>|S| = æ­£åœ¨ç­‰å¾…ï¼ˆè¢« blockï¼‰çš„ process æ•¸é‡<br>
ä¾‹ï¼šS = -3 ä»£è¡¨æœ‰ 3 å€‹ process è¢«æ“‹åœ¨ wait ä¸Š</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="POSIX-Semaphor">POSIX Semaphor</h2>
<ul>
<li>Semaphore æ˜¯ <strong>POSIX æ¨™æº–</strong>çš„ä¸€éƒ¨åˆ† ï¼Œ <strong>ä¸æ˜¯ pthread çš„ä¸€éƒ¨åˆ†</strong></li>
<li>Semaphore å¯ä»¥ç”¨åœ¨ï¼š
<ul>
<li>process â†” processï¼ˆè·¨è¡Œç¨‹åŒæ­¥ï¼‰</li>
<li>thread â†” threadï¼ˆåŒä¸€è¡Œç¨‹å…§å¤šåŸ·è¡Œç·’åŒæ­¥ï¼‰</li>
</ul>
</li>
</ul>
<p>##ã€€Correctness Properties</p>
<ul>
<li>Mutual Exclusionï¼šå¯ä»¥</li>
<li>Progressï¼šé€šå¸¸å¯ä»¥</li>
<li>Bounded Waitingï¼šä¸ä¿è­‰
<ul>
<li>æœƒä¸æœƒé¤“æ­»starvationå–æ±ºæ–¼ç­‰å¾…éšŠåˆ—æ€éº¼é¸äºº
<ul>
<li>FIFOï¼šæ¯”è¼ƒæœ‰ bounded waiting</li>
<li>LIFO / priorityï¼šå¯èƒ½æœ‰äººæ°¸é è¢«æ’éšŠ â†’ starvation</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="Advantages-and-Disadvantages">Advantages and Disadvantages</h2>
<ul>
<li>å„ªé»:
<ul>
<li>æŠ½è±¡å±¤æ›´é«˜ã€å¯ç§»æ¤ã€ä¸ä¾è³´ç‰¹å®šç¡¬é«”ã€å¯ç”¨ block é¿å… busy waiting</li>
<li>ä¹Ÿæ”¯æ´ã€Œäº’æ–¥ã€+ã€ŒåŒæ­¥ï¼ˆé †åºç´„æŸï¼‰ã€å…©ç¨®ç”¨é€”</li>
</ul>
</li>
<li>ç¼ºé»:
<ul>
<li>å®¹æ˜“å¯«éŒ¯</li>
<li>ä¸å…·çµæ§‹æ€§</li>
<li>æ²’æœ‰ ownershipï¼ˆæ‰€æœ‰æ¬Šï¼‰</li>
</ul>
</li>
</ul>
<h2 id="Cooperation-Synchronizationï¼ˆåˆä½œå¼åŒæ­¥ï¼šå¼·åˆ¶é †åºï¼‰">Cooperation Synchronizationï¼ˆåˆä½œå¼åŒæ­¥ï¼šå¼·åˆ¶é †åºï¼‰</h2>
<ul>
<li>
<p>éœ€æ±‚</p>
<ul>
<li>P1 åš S1</li>
<li>P2 åš S2</li>
<li>è¦å®šï¼šS2 å¿…é ˆç­‰ S1 åšå®Œ</li>
</ul>
</li>
<li>
<p>çœ‹åˆ° wait(x)ï¼šä»£è¡¨ã€Œæˆ‘éœ€è¦ x é€™å€‹äº‹ä»¶å…ˆå®Œæˆã€</p>
</li>
<li>
<p>çœ‹åˆ° signal(x)ï¼šä»£è¡¨ã€Œæˆ‘å®Œæˆäº†æŸå€‹äº‹ä»¶ï¼Œæ”¾è¡Œå¾Œé¢çš„äººã€</p>
</li>
</ul>
<h2 id="Deadlocks-and-Starvation">Deadlocks and Starvation</h2>
<ul>
<li>
<p>Deadlock</p>
<ul>
<li>å…©å€‹æˆ–æ›´å¤š process éƒ½åœ¨ç­‰
<ul>
<li>è€Œã€Œèƒ½è®“æˆ‘ç¹¼çºŒçš„äº‹ä»¶ã€åªèƒ½ç”±ã€Œæ­£åœ¨ç­‰çš„é‚£äº›äººã€é€ æˆ<br>
â†’ å½¢æˆé–‰ç’°ï¼Œæ°¸é æ²’äººèƒ½å…ˆå‹•</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Starvation</p>
<ul>
<li>æŸå€‹ process ä¸€ç›´ç­‰ä¸åˆ°ï¼Œä½†ç³»çµ±å…¶å¯¦ä¸€ç›´åœ¨å‰é€²</li>
<li>å¸¸è¦‹åŸå› ï¼š
<ul>
<li>semaphore ç­‰å¾…éšŠåˆ—æ˜¯ LIFO æˆ–ä¸å…¬å¹³ç­–ç•¥<br>
â†’ æ–°ä¾†çš„æ°¸é æ’éšŠï¼Œè€çš„æ°¸é è¼ªä¸åˆ°ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1>Classical Synchronization Problems</h1>
<ul>
<li>
<p>Purpose</p>
<ul>
<li><strong>Benchmark problems</strong> : æŠŠåŒæ­¥å•é¡Œã€Œæ¨™æº–åŒ–ã€</li>
<li>éƒ½è¦æ‹¿ä¾†ã€Œå¯¦æˆ°é©—è­‰ã€</li>
<li>å…‰èªªã€Œæˆ‘é€™å€‹ lock å¾ˆæ£’ã€ä¸å¤ ï¼Œè¦æ‹¿<strong>ç¶“å…¸å•é¡Œä¾†æ¸¬</strong></li>
</ul>
</li>
<li>
<p>ä¸‰å¤§ç¶“å…¸å•é¡Œ</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>å•é¡Œ</th>
<th>é‡é»</th>
</tr>
</thead>
<tbody>
<tr>
<td>Producerâ€“Consumerï¼ˆBounded Bufferï¼‰</td>
<td><strong>å®¹é‡é™åˆ¶ + åŒæ­¥</strong></td>
</tr>
<tr>
<td>Readersâ€“Writers</td>
<td><strong>è®€å¯«è¡çª + å„ªå…ˆæ¬Š</strong></td>
</tr>
<tr>
<td>Dining Philosophers</td>
<td><strong>è³‡æºå…±äº« + deadlock / starvation</strong></td>
</tr>
</tbody>
</table>
<ul>
<li>Producerâ€“Consumer vs Readersâ€“Writers vs Dining Philosophers</li>
</ul>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th><strong>Bounded-Buffer</strong></th>
<th><strong>Readersâ€“Writers</strong></th>
<th><strong>Dining Philosophers</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>å•é¡Œé¡å‹</strong></td>
<td>ç”Ÿç”¢ / æ¶ˆè²»</td>
<td>è®€ / å¯«</td>
<td>è³‡æºç«¶çˆ­</td>
</tr>
<tr>
<td><strong>å…±äº«è³‡æº</strong></td>
<td>æœ‰é™å€‹ bufferï¼ˆn å€‹ï¼‰</td>
<td>å…±äº«è³‡æ–™ï¼ˆDB / fileï¼‰</td>
<td>ç­·å­ï¼ˆè³‡æºï¼‰</td>
</tr>
<tr>
<td><strong>è§’è‰²</strong></td>
<td>Producerã€Consumer</td>
<td>Readerã€Writer</td>
<td>Philosopher</td>
</tr>
<tr>
<td><strong>è³‡æºæ•¸é‡</strong></td>
<td>æœ‰é™ï¼ˆnï¼‰</td>
<td>1 ä»½è³‡æ–™</td>
<td>æ¯äººå·¦å³å„ 1 æ”¯</td>
</tr>
<tr>
<td><strong>æ ¸å¿ƒé™åˆ¶</strong></td>
<td>æœ‰å®¹é‡ä¸Šé™</td>
<td>Writer å¿…é ˆç¨ä½”</td>
<td>ä¸€æ¬¡è¦æ‹¿ 2 æ”¯</td>
</tr>
<tr>
<td><strong>å…è¨±ä¸¦è¡Œ</strong></td>
<td>å¤šå€‹ Producer / Consumer</td>
<td>å¤šå€‹ Reader å¯åŒæ™‚</td>
<td>å¤šäººæ€è€ƒ</td>
</tr>
<tr>
<td><strong>ä¸å…è¨±ä¸¦è¡Œ</strong></td>
<td>åŒä¸€ buffer åŒæ™‚ä½¿ç”¨</td>
<td>Writer èˆ‡ä»»ä½•äºº</td>
<td>åŒä¸€ç­·å­è¢«å…©äººæ‹¿</td>
</tr>
<tr>
<td><strong>ä¸»è¦åŒæ­¥ç›®çš„</strong></td>
<td>âœ” ä¸è¶…ç”Ÿç”¢<br>âœ” ä¸ç©ºæ¶ˆè²»</td>
<td>âœ” ä¿è­·è³‡æ–™ä¸€è‡´æ€§</td>
<td>âœ” é¿å…ç³»çµ±å¡æ­»</td>
</tr>
<tr>
<td><strong>å…¸å‹éŒ¯èª¤</strong></td>
<td>ç”Ÿç”¢å¤ªå¤šæˆ–æ¶ˆè²»å¤ªå¿«</td>
<td>å„ªå…ˆæ¬Šè¨­è¨ˆéŒ¯èª¤</td>
<td>æ‹¿ç­·å­é †åºéŒ¯</td>
</tr>
<tr>
<td><strong>Deadlock å¯èƒ½ï¼Ÿ</strong></td>
<td>âŒï¼ˆæ­£å¸¸è¨­è¨ˆä¸æœƒï¼‰</td>
<td>âŒï¼ˆé™¤éè¨­è¨ˆå¾ˆçˆ›ï¼‰</td>
<td>âœ” <strong>éå¸¸å…¸å‹</strong></td>
</tr>
<tr>
<td><strong>Starvation å¯èƒ½ï¼Ÿ</strong></td>
<td>âŒ</td>
<td>âœ”ï¼ˆReaders æˆ– Writersï¼‰</td>
<td>âœ”</td>
</tr>
</tbody>
</table>
<h1>Monitors</h1>
<ul>
<li>
<p>Motivation of Monitors</p>
<ul>
<li>Semaphore å¾ˆæœ‰æ•ˆï¼Œä½†ã€Œ<strong>æ­£ç¢ºæ€§å®Œå…¨é ç¨‹å¼å“¡</strong>ã€</li>
</ul>
</li>
<li>
<p>Monitor æ˜¯æ›´é«˜éšçš„åŒæ­¥çµæ§‹</p>
</li>
<li>
<p>æ ¸å¿ƒåŠŸèƒ½ï¼š<strong>è‡ªå‹•äº’æ–¥ï¼ˆautomatic mutual exclusionï¼‰</strong></p>
</li>
<li>
<p>Monitor ç”±å…©éƒ¨åˆ†æ§‹æˆï¼š</p>
<ul>
<li>å…±äº«è³‡æ–™ï¼ˆvariables / stateï¼‰</li>
<li>æ“ä½œå…±äº«è³‡æ–™çš„æ–¹æ³•ï¼ˆprocedures/functionsï¼‰<br>
è€Œä¸”å¤–é¢åªèƒ½é€éæ–¹æ³•å­˜å–è³‡æ–™ã€‚</li>
</ul>
</li>
<li>
<p>åŒä¸€æ™‚é–“åªå…è¨±<strong>ä¸€å€‹</strong> thread/process åœ¨ monitor è£¡åŸ·è¡Œ<br>
â†’ é€™å°±æ˜¯ monitor <strong>è‡ªå¸¶çš„ mutual exclusion</strong>ã€‚</p>
</li>
</ul>
<h2 id="Similarity-to-Object-Oriented-Classes">Similarity to Object-Oriented Classes</h2>
<ul>
<li>
<p>Monitor å¾ˆåƒç‰©ä»¶å°å‘ classï¼š</p>
<ul>
<li>å°è£ï¼ˆEncapsulationï¼‰ï¼šè³‡æ–™ + æ“ä½œæ”¾ä¸€èµ·</li>
<li>è³‡è¨Šéš±è—ï¼ˆData hidingï¼‰ï¼šå…§éƒ¨ç‹€æ…‹ privateï¼Œå¤–é¢ä¸èƒ½ç›´æ¥ç¢°</li>
<li>å…¬é–‹ä»‹é¢ï¼ˆPublic interfaceï¼‰ï¼šå¤–ç•Œåªèƒ½å‘¼å«æ–¹æ³•</li>
</ul>
</li>
<li>
<p>å¤–éƒ¨ code <strong>ä¸èƒ½ç›´æ¥å­˜å–</strong> monitor å…§éƒ¨è®Šæ•¸</p>
</li>
</ul>
<h2 id="Condition-Variables-in-Monitor">Condition Variables in Monitor</h2>
<ul>
<li>
<p>Monitor <strong>åªä¿è­‰ mutual exclusion</strong>ï¼Œä¸ä¿è­‰ä½ è¦çš„ã€Œæ¢ä»¶åŒæ­¥ã€ã€‚</p>
</li>
<li>
<p>å¾ˆå¤šå•é¡Œéœ€è¦ã€Œç­‰åˆ°æ¢ä»¶æˆç«‹ã€æ‰ç¹¼çºŒï¼Œä¾‹å¦‚ bounded bufferï¼š</p>
<ul>
<li>buffer æ»¿ï¼šproducer ä¸èƒ½åš â†’ è¦ç­‰ notFull</li>
<li>buffer ç©ºï¼šconsumer ä¸èƒ½æ‹¿ â†’ è¦ç­‰ notEmpty</li>
</ul>
</li>
<li>
<p>monitor æä¾› <strong>condition variables</strong></p>
<ul>
<li>x.wait()
<ul>
<li>æŠŠè‡ªå·±ç¡è‘—ï¼ˆsuspendï¼‰</li>
<li>é‡‹æ”¾ monitor lockï¼ˆä¸ç„¶åˆ¥äººé€²ä¸ä¾†æ”¹æ¢ä»¶ï¼‰</li>
<li>ç­‰è¢«å–šé†’å¾Œï¼Œå†å›ä¾†ç¹¼çºŒ</li>
</ul>
</li>
<li>x.signal()
<ul>
<li>å–šé†’ ä¸€å€‹ ç­‰åœ¨ x çš„äºº</li>
<li>è‹¥æ²’äººç­‰ â†’ æ²’æ•ˆæœï¼ˆsignal lostï¼‰</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<blockquote>
<p>ä½œè€…æœ€å¾Œçš„æ„Ÿæƒ³ : æˆ‘çŸ¥é“åˆè‡­åˆé•·ï¼Œä½†æˆ‘çœŸçš„ä¸çŸ¥é“è¦æ€éº¼ç¸®æ¸›äº†ï¼Œå¯èƒ½ä½œæ¥­ç³»çµ±å°±æ˜¯é€™æ¨£å§â€¦! &lt;3<br>
å› ç‚ºæ™‚é–“ç·Šæ€¥ï¼Œæˆ‘ä¸‹æ¬¡æœƒè¨˜å¾—ç¾åŒ–çš„ å¯èƒ½æœƒè«‹æ±‚GPTçš„æ”¯æ´å§</p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://YowDesert.github.io">YowDesert</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é€£çµ: </span><span class="post-copyright-info"><a href="https://yowdesert.github.io/posts/90aa57da.html">https://yowdesert.github.io/posts/90aa57da.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæ¬Šè²æ˜: </span><span class="post-copyright-info">æœ¬éƒ¨è½æ ¼æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ¥è²æ˜å¤–ï¼Œå‡æ¡ç”¨<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> æˆæ¬Šå”è­°ã€‚è½‰è¼‰è«‹è¨»æ˜ä¾†æº <a href="https://YowDesert.github.io" target="_blank">YD's è³‡è¨Šå­¸ç¿’ç­†è¨˜</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E4%BD%9C%E6%A5%AD%E7%B3%BB%E7%B5%B1/">ä½œæ¥­ç³»çµ±</a></div><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/4f5b5fb4.html" title="(è³‡æ–™åº«ç³»çµ±) Basic SQL (Structured Query Language)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">(è³‡æ–™åº«ç³»çµ±) Basic SQL (Structured Query Language)</div></div><div class="info-2"><div class="info-item-1">ç°¡çŸ­èªªæ˜ï¼š  ä¸»é¡Œï¼šBasic SQL æœ¬ç« é‡é»ï¼š  SQL çš„ç”±ä¾†èˆ‡ã€Œé—œè¯æ¨¡å‹ã€å·®ç•° SQL ä¸‰ç¨®èªè¨€ï¼šDDL / DML / DCL Schema / Catalog / CREATE TABLE è³‡æ–™å‹æ…‹ &amp; Domain å„ç¨® Constraintsï¼ˆPK / FK / UNIQUE / NOT NULL / CHECK / DEFAULTï¼‰ åŸºæœ¬æŸ¥è©¢ï¼šSELECT-FROM-WHEREã€DISTINCTã€é›†åˆé‹ç®— INSERT / DELETE / UPDATE ä¿®æ”¹è³‡æ–™     1. Basic SQL &amp; é—œè¯æ¨¡å‹å·®ç•° 1-1 SQLçš„ç”±ä¾†   èµ·æºï¼šå¾ tuple calculusï¼ˆé—œè¯è¬‚è©æ¼”ç®—ï¼‰ç™¼å±•å‡ºèªè¨€ SQUARE â†’ SEQUEL â†’ SQL   SQL åŸæœ¬æ˜¯ SEQUEL to SQUARE çš„ç¸®å¯«ï¼Œå¾Œä¾†å› ç‰ˆæ¬Šæ”¹æˆ SQLï¼ˆStructured Query Languageï¼‰ â†’ ç›®å‰éƒ½ç¿’æ…£å«ã€ŒStructured Query Languageã€ã€‚   1-2 åè©å°ç…§ï¼ˆæ•¸å­¸ vs å¯¦ä½œï¼‰ ç†è«–çš„é—œè¯æ¨¡å‹ä½¿ç”¨æ¯”è¼ƒã€Œæ•¸å­¸ã€çš„åç¨±ï¼š    ...</div></div></div></a><a class="pagination-related" href="/posts/52554cd4.html" title="(ç·šæ€§ä»£æ•¸) çŸ©é™£èˆ‡çŸ©é™£é‹ç®—"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">(ç·šæ€§ä»£æ•¸) çŸ©é™£èˆ‡çŸ©é™£é‹ç®—</div></div><div class="info-2"><div class="info-item-1">çŸ©é™£èˆ‡çŸ©é™£é‹ç®—åŸºç¤ åœ¨ç·šæ€§ä»£æ•¸ä¸­ï¼ŒçŸ©é™£ï¼ˆMatrixï¼‰æ˜¯ä¸€ç¨®ç”¨æ–¼è¡¨ç¤ºç·šæ€§è®Šæ›èˆ‡è§£ç·šæ€§æ–¹ç¨‹çµ„çš„é‡è¦å·¥å…·ã€‚ çŸ©é™£ç”±æ•¸å­—ä¾ç…§**åˆ—ï¼ˆrowï¼‰èˆ‡è¡Œï¼ˆcolumnï¼‰**æ’åˆ—æˆé•·æ–¹å½¢é™£åˆ—ã€‚  1. çŸ©é™£çš„è¡¨ç¤ºæ³• ä»¤ $F$ ç‚ºä¸€å€‹åŸŸï¼ˆFieldï¼‰ï¼Œä¸€å€‹ $m \times n$ çš„çŸ©é™£ $A$ ç‚ºï¼š $$ A = \begin{bmatrix} a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} \\ a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ a_{m1} &amp; a_{m2} &amp; \cdots &amp; a_{mn} \end{bmatrix}, \quad a_{ij} \in F $$ å…¶ä¸­ï¼š  $A$ ç‚º $m$ åˆ— $n$ è¡ŒçŸ©é™£ $a_{ij}$ï¼šç¬¬ $i$ åˆ—ã€ç¬¬ $j$ è¡Œå…ƒç´  è¡Œï¼ˆrowï¼‰ï¼šæ©«å‘æ’åˆ— åˆ—ï¼ˆcolumnï¼‰ï¼šç¸±å‘æ’åˆ— $F^{m \times n}$ï¼šæ‰€æœ‰ ...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸é—œæ¨è–¦</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/67c68839.html" title="(ä½œæ¥­ç³»çµ±) Deadlock Definition, Avoidance and Resolution"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-13</div><div class="info-item-2">(ä½œæ¥­ç³»çµ±) Deadlock Definition, Avoidance and Resolution</div></div><div class="info-2"><div class="info-item-1">DeadlockåŸºæœ¬æ¦‚å¿µ 1. Deadlock æ˜¯ä»€éº¼ï¼Ÿ Deadlock æŒ‡çš„æ˜¯ï¼š  ä¸€çµ„ processes å½¼æ­¤ç­‰å¾…å°æ–¹æ‰€æŒæœ‰çš„è³‡æºï¼Œå°è‡´æ‰€æœ‰ process éƒ½ç„¡æ³•ç¹¼çºŒåŸ·è¡Œã€‚  Deadlock çš„ç‰¹å¾µ  æ¯å€‹ processï¼š  å·²æŒæœ‰è‡³å°‘ä¸€å€‹è³‡æº åŒæ™‚ç­‰å¾…å¦ä¸€å€‹ process æŒæœ‰çš„è³‡æº   çµæœï¼šå¤§å®¶äº’ç­‰ï¼Œç³»çµ±åœä½   2. Deadlock ç¯„ä¾‹ Example 1ï¼šå…©å€‹ processesã€å…©å€‹è³‡æº  P1 æŒæœ‰ R1ï¼Œç­‰å¾… R2 P2 æŒæœ‰ R2ï¼Œç­‰å¾… R1 â†’ äº’ç›¸ç­‰å¾…ï¼Œç™¼ç”Ÿ deadlock  Example 2ï¼šSemaphore A èˆ‡ B 12P1: wait(A); wait(B); ...; signal(B); signal(A);P2: wait(B); wait(A); ...; signal(A); signal(B);  è‹¥ P1 å…ˆæ‹¿åˆ° Aã€P2 å…ˆæ‹¿åˆ° B ä¸‹ä¸€æ­¥å½¼æ­¤éƒ½åœ¨ç­‰å°æ–¹ â†’ deadlock   Deadlock çš„å››å€‹å¿…è¦æ¢ä»¶ Deadlock ç•¶ä¸”åƒ…ç•¶ä¸‹åˆ—å››å€‹æ¢ä»¶åŒæ™‚æˆç«‹ï¼š  Mutual Exclusionï¼ˆäº’æ–¥ï¼‰...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">YowDesert</div><div class="author-info-description">é€™æ˜¯YowDesertçš„éƒ¨è½æ ¼ï¼Œè¨˜éŒ„å­¸ç¿’è³‡è¨Šå·¥ç¨‹é ˜åŸŸçš„éç¨‹å’Œå¿ƒå¾—ï¼Œä¸¦ä»¥ç°¡å–®ç™½è©±çš„æ–¹å¼å‘ˆç¾ï¼Œä¸€èµ·å’Œæˆ‘è¸å…¥è³‡è¨Šä¸–ç•Œå§ï¼Œæœ‰èˆˆè¶£çš„è©±æ­¡è¿Followæˆ‘æ­ã€‚</div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">æ¨™ç±¤</div><div class="length-num">8</div></a><a href="/categories/"><div class="headline">åˆ†é¡</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/yowdesert"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/yowdesert" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:csaidesert@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®éŒ„</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">ç°¡çŸ­èªªæ˜ï¼š</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">Background</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%95%8F%E9%A1%8C%E8%88%87%E8%A7%A3%E6%B1%BA"><span class="toc-number">2.1.</span> <span class="toc-text">å•é¡Œèˆ‡è§£æ±º</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Consumer-and-Producer-Problem"><span class="toc-number">2.2.</span> <span class="toc-text">Consumer and Producer Problem :</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Race-Condition"><span class="toc-number">2.3.</span> <span class="toc-text">Race Condition</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DeadLock"><span class="toc-number">2.4.</span> <span class="toc-text">DeadLock</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E5%89%87"><span class="toc-number">2.5.</span> <span class="toc-text">åŸå‰‡</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">Critical-Section</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#The-Critical-Section-Problem"><span class="toc-number">3.1.</span> <span class="toc-text">The Critical-Section Problem</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Requirements-for-a-Valid-Solution"><span class="toc-number">3.2.</span> <span class="toc-text">Requirements for a Valid Solution</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Critical-Section-Solutions-%E2%80%93-Software-Solutions"><span class="toc-number">3.3.</span> <span class="toc-text">Critical Section Solutions â€“ Software Solutions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Comparison"><span class="toc-number">3.4.</span> <span class="toc-text">Comparison</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text">Software Solutions</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Algorithm-for-two-Processes"><span class="toc-number">4.1.</span> <span class="toc-text">Algorithm for two Processes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Peterson%E2%80%99s-Solution"><span class="toc-number">4.2.</span> <span class="toc-text">Petersonâ€™s Solution</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Correctness-Proof-of-Peterson%E2%80%99s-Solution"><span class="toc-number">4.2.1.</span> <span class="toc-text">Correctness Proof of Petersonâ€™s Solution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Turn-Algorithm-V-S-Peterson%E2%80%99s-Algorithm"><span class="toc-number">4.2.2.</span> <span class="toc-text">Turn Algorithm V.S. Petersonâ€™s Algorithm</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dekker%E2%80%99s-Algorithm"><span class="toc-number">4.3.</span> <span class="toc-text">Dekkerâ€™s Algorithm</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Dekker-vs-Peterson"><span class="toc-number">4.3.1.</span> <span class="toc-text">Dekker vs Peterson</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Limitations-of-Dekker%E2%80%99s-Algorithm"><span class="toc-number">4.3.2.</span> <span class="toc-text">Limitations of Dekkerâ€™s Algorithm</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bakery-Algorithm"><span class="toc-number">4.4.</span> <span class="toc-text">Bakery Algorithm</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F%E8%A6%8F%E5%89%87%EF%BC%9ALexicographic-Ordering-%E5%AD%97%E5%85%B8%E9%A0%86%E5%BA%8F"><span class="toc-number">4.4.1.</span> <span class="toc-text">æ’åºè¦å‰‡ï¼šLexicographic Ordering (å­—å…¸é †åº)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bakery-Entry-Section"><span class="toc-number">4.4.2.</span> <span class="toc-text">Bakery Entry Section</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%82%BA%E4%BB%80%E9%BA%BC%E4%B8%80%E5%AE%9A%E8%A6%81-choosing"><span class="toc-number">4.4.3.</span> <span class="toc-text">ç‚ºä»€éº¼ä¸€å®šè¦ choosing[]?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Correctness-Proof"><span class="toc-number">4.4.4.</span> <span class="toc-text">Correctness Proof</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bekery%E2%80%99s-algorithm%E5%84%AA%E7%BC%BA%E9%BB%9E%E7%B8%BD%E8%A1%A8"><span class="toc-number">4.4.5.</span> <span class="toc-text">Bekeryâ€™s algorithmå„ªç¼ºé»ç¸½è¡¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E9%9D%A2%E7%9A%84%E7%B8%BD%E7%B5%90"><span class="toc-number">4.4.6.</span> <span class="toc-text">å‰é¢çš„ç¸½çµ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pthread-Lock-Mutex-Routines"><span class="toc-number">4.5.</span> <span class="toc-text">Pthread Lock&#x2F;Mutex Routines</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Condition-Variables%EF%BC%88CV%EF%BC%89"><span class="toc-number">4.6.</span> <span class="toc-text">Condition Variablesï¼ˆCVï¼‰</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">5.</span> <span class="toc-text">Hardware Support for Synchronization</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%94%E8%BB%9F%E9%AB%94%E7%9A%84%E9%99%90%E5%88%B6"><span class="toc-number">5.1.</span> <span class="toc-text">ç´”è»Ÿé«”çš„é™åˆ¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Approach-1-Disable-Interrupts"><span class="toc-number">5.2.</span> <span class="toc-text">Approach 1: Disable Interrupts</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Approach-2-Hardware-Atomic-Instructions"><span class="toc-number">5.3.</span> <span class="toc-text">Approach 2: Hardware Atomic Instructions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mutual-Exclusion-3-Common-Atomic-Instruction"><span class="toc-number">5.4.</span> <span class="toc-text">Mutual Exclusion 3 Common Atomic Instruction</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">6.</span> <span class="toc-text">Semaphore</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Type-of-Semaphore"><span class="toc-number">6.1.</span> <span class="toc-text">Type of Semaphore</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Two-Atomic-Operation"><span class="toc-number">6.1.1.</span> <span class="toc-text">Two Atomic Operation :</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Issue"><span class="toc-number">6.1.2.</span> <span class="toc-text">Issue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%81%A9%E5%90%88%E6%99%82%E6%A9%9F"><span class="toc-number">6.1.3.</span> <span class="toc-text">é©åˆæ™‚æ©Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E9%81%A9%E5%90%88%E6%99%82%E6%A9%9F"><span class="toc-number">6.1.4.</span> <span class="toc-text">ä¸é©åˆæ™‚æ©Ÿ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Non-busy-waiting%EF%BC%88%E6%9C%89%E7%AD%89%E5%BE%85%E9%9A%8A%E5%88%97%E7%9A%84-semaphore%EF%BC%8C%E7%9C%9F%E6%AD%A3-OS-%E6%9C%83%E7%94%A8%EF%BC%89"><span class="toc-number">6.2.</span> <span class="toc-text">Non-busy waitingï¼ˆæœ‰ç­‰å¾…éšŠåˆ—çš„ semaphoreï¼ŒçœŸæ­£ OS æœƒç”¨ï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#POSIX-Semaphor"><span class="toc-number">6.3.</span> <span class="toc-text">POSIX Semaphor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Advantages-and-Disadvantages"><span class="toc-number">6.4.</span> <span class="toc-text">Advantages and Disadvantages</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Cooperation-Synchronization%EF%BC%88%E5%90%88%E4%BD%9C%E5%BC%8F%E5%90%8C%E6%AD%A5%EF%BC%9A%E5%BC%B7%E5%88%B6%E9%A0%86%E5%BA%8F%EF%BC%89"><span class="toc-number">6.5.</span> <span class="toc-text">Cooperation Synchronizationï¼ˆåˆä½œå¼åŒæ­¥ï¼šå¼·åˆ¶é †åºï¼‰</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Deadlocks-and-Starvation"><span class="toc-number">6.6.</span> <span class="toc-text">Deadlocks and Starvation</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">7.</span> <span class="toc-text">Classical Synchronization Problems</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">8.</span> <span class="toc-text">Monitors</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Similarity-to-Object-Oriented-Classes"><span class="toc-number">8.1.</span> <span class="toc-text">Similarity to Object-Oriented Classes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Condition-Variables-in-Monitor"><span class="toc-number">8.2.</span> <span class="toc-text">Condition Variables in Monitor</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/67c68839.html" title="(ä½œæ¥­ç³»çµ±) Deadlock Definition, Avoidance and Resolution">(ä½œæ¥­ç³»çµ±) Deadlock Definition, Avoidance and Resolution</a><time datetime="2025-12-13T08:12:16.201Z" title="ç™¼è¡¨æ–¼ 2025-12-13 16:12:16">2025-12-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/4f5b5fb4.html" title="(è³‡æ–™åº«ç³»çµ±) Basic SQL (Structured Query Language)">(è³‡æ–™åº«ç³»çµ±) Basic SQL (Structured Query Language)</a><time datetime="2025-12-09T13:16:17.006Z" title="ç™¼è¡¨æ–¼ 2025-12-09 21:16:17">2025-12-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/52554cd4.html" title="(ç·šæ€§ä»£æ•¸) çŸ©é™£èˆ‡çŸ©é™£é‹ç®—">(ç·šæ€§ä»£æ•¸) çŸ©é™£èˆ‡çŸ©é™£é‹ç®—</a><time datetime="2025-08-14T00:40:00.000Z" title="ç™¼è¡¨æ–¼ 2025-08-14 08:40:00">2025-08-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/90aa57da.html" title="(ä½œæ¥­ç³»çµ±) Process and Concurrency - Synchronization Concepts">(ä½œæ¥­ç³»çµ±) Process and Concurrency - Synchronization Concepts</a><time datetime="2025-08-14T00:40:00.000Z" title="ç™¼è¡¨æ–¼ 2025-08-14 08:40:00">2025-08-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/5cf5d8d8.html" title="[é›¢æ•£æ•¸å­¸] åŸºæœ¬ç¬¦è™Ÿèˆ‡æ¦‚å¿µé€ŸæŸ¥è¡¨">[é›¢æ•£æ•¸å­¸] åŸºæœ¬ç¬¦è™Ÿèˆ‡æ¦‚å¿µé€ŸæŸ¥è¡¨</a><time datetime="2025-08-11T23:00:00.000Z" title="ç™¼è¡¨æ–¼ 2025-08-12 07:00:00">2025-08-12</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/nav_Picture.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By YowDesert</span><span class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>ä¸»é¡Œ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é–±è®€æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥å¤œæ¨¡å¼åˆ‡æ›"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å–®æ¬„å’Œé›™æ¬„åˆ‡æ›"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è¨­å®š"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®éŒ„"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é ‚ç«¯"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.4/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        loader: {
          load: [
            // Four font extension packages (optional)
            //- '[tex]/bbm',
            //- '[tex]/bboldx',
            //- '[tex]/dsfont',
            '[tex]/mhchem'
          ],
          paths: {
            'mathjax-newcm': '[mathjax]/../@mathjax/mathjax-newcm-font',

            //- // Four font extension packages (optional)
            //- 'mathjax-bbm-extension': '[mathjax]/../@mathjax/mathjax-bbm-font-extension',
            //- 'mathjax-bboldx-extension': '[mathjax]/../@mathjax/mathjax-bboldx-font-extension',
            //- 'mathjax-dsfont-extension': '[mathjax]/../@mathjax/mathjax-dsfont-font-extension',
            'mathjax-mhchem-extension': '[mathjax]/../@mathjax/mathjax-mhchem-font-extension'
          }
        },
        output: {
          font: 'mathjax-newcm',
        },
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
          packages: {
            '[+]': [
              'mhchem'
            ]
          }
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          menuOptions: {
            settings: {
              enrich: false  // Turn off Braille and voice narration text automatic generation
            }
          },
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax@4.0.0/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script></div><script async data-pjax src="/"></script></div></body></html>